# ğŸ”¥ çƒ­æ¦œçˆ¬è™« (Hotlist Crawler)# çƒ­æ¦œçˆ¬è™«é¡¹ç›® - ä½¿ç”¨æŒ‡å—



ä¸€ä¸ªåŸºäº FastAPI çš„å¤šå¹³å°å†…å®¹çˆ¬è™«ç³»ç»Ÿï¼Œæ”¯æŒå¾®ä¿¡å…¬ä¼—å·ã€çŸ¥ä¹ã€å¾®åšç­‰ä¸»æµå¹³å°çš„å†…å®¹æŠ“å–ï¼Œå…·å¤‡æ™ºèƒ½å­˜å‚¨ã€å›¾ç‰‡ä¸‹è½½ã€å¤šæ ¼å¼è¾“å‡ºç­‰åŠŸèƒ½ã€‚## ğŸ¯ é¡¹ç›®ç®€ä»‹



![Python](https://img.shields.io/badge/python-v3.8+-blue.svg)è¿™æ˜¯ä¸€ä¸ªåŸºäº FastAPI çš„é€šç”¨å†…å®¹æŠ“å– API æœåŠ¡ï¼Œç°å·²æ•´åˆäº†å¼ºå¤§çš„å¾®ä¿¡å…¬ä¼—å·æ–‡ç« æŠ“å–åŠŸèƒ½ã€‚é¡¹ç›®æ”¯æŒï¼š

![FastAPI](https://img.shields.io/badge/FastAPI-0.68+-green.svg)

![License](https://img.shields.io/badge/license-MIT-blue.svg)- **æ™ºèƒ½å¹³å°è¯†åˆ«**ï¼šè‡ªåŠ¨è¯†åˆ«çŸ¥ä¹ã€å¾®ä¿¡å…¬ä¼—å·ç­‰å¹³å°

- **åçˆ¬è™«å¤„ç†**ï¼šä½¿ç”¨ Playwright å¤„ç† JavaScript æ¸²æŸ“å’Œåçˆ¬è™«æœºåˆ¶

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§- **å›¾ç‰‡ä¸‹è½½**ï¼šè‡ªåŠ¨ä¸‹è½½æ–‡ç« ä¸­çš„å›¾ç‰‡åˆ°æœ¬åœ°

- **Markdown è½¬æ¢**ï¼šå°†æ–‡ç« è½¬#### 3. Playwright æµè§ˆå™¨æœªå®‰è£…

- ğŸ”¥ **å¤šå¹³å°æ”¯æŒ**: æ”¯æŒå¾®ä¿¡å…¬ä¼—å·ã€çŸ¥ä¹é—®é¢˜/æ–‡ç« ã€å¾®åšæœç´¢ç­‰ä¸»æµå¹³å°```

- ğŸš€ **å¼‚æ­¥å¤„ç†**: åŸºäºFastAPIçš„é«˜æ€§èƒ½å¼‚æ­¥æ¶æ„playwright._impl._api_types.Error: Executable doesn't exist

- ğŸ§  **æ™ºèƒ½è§£æ**: ä½¿ç”¨Playwrightå¤„ç†JavaScriptæ¸²æŸ“é¡µé¢```

- ğŸ’¾ **æ™ºèƒ½ç¼“å­˜**: Redisç¼“å­˜æå‡æ€§èƒ½ï¼Œå†…å­˜ç¼“å­˜ä½œä¸ºå¤‡é€‰

- ğŸ“± **ç§»åŠ¨é€‚é…**: æ¨¡æ‹Ÿç§»åŠ¨è®¾å¤‡è®¿é—®ï¼Œè·å–æœ€ä½³å†…å®¹**è§£å†³æ–¹æ¡ˆï¼š**

- ğŸ–¼ï¸ **å›¾ç‰‡å¤„ç†**: è‡ªåŠ¨ä¸‹è½½å’Œå¤„ç†æ–‡ç« ä¸­çš„å›¾ç‰‡å’Œè§†é¢‘```bash

- ğŸ“„ **å¤šæ ¼å¼è¾“å‡º**: æ”¯æŒçº¯æ–‡æœ¬ã€HTMLã€Markdownæ ¼å¼playwright install chromium

- ğŸ  **æœ¬åœ°å­˜å‚¨**: è‡ªåŠ¨ä¿å­˜æ‰€æœ‰å†…å®¹åˆ°æœ¬åœ°ï¼ŒæŒ‰å¹³å°åˆ†ç±»```

- ğŸ“‚ **æ™ºèƒ½ç»„ç»‡**: æ¯ç¯‡æ–‡ç« ç‹¬ç«‹ç›®å½•ï¼ŒåŒ…å«æ–‡æœ¬ã€å›¾ç‰‡ã€å…ƒæ•°æ®

- ğŸ” **å­˜å‚¨ç®¡ç†**: æä¾›APIæŸ¥çœ‹å’Œç®¡ç†æœ¬åœ°å­˜å‚¨å†…å®¹#### 4. Windows ç³»ç»Ÿ Playwright å¼‚æ­¥é”™è¯¯

```

## ğŸ› ï¸ æŠ€æœ¯æ ˆNotImplementedError: Task exception was never retrieved

```

- **Webæ¡†æ¶**: FastAPI

- **æµè§ˆå™¨è‡ªåŠ¨åŒ–**: Playwright**è§£å†³æ–¹æ¡ˆï¼š**

- **HTMLè§£æ**: BeautifulSoup4- å·²è‡ªåŠ¨ä¿®å¤ï¼šç³»ç»Ÿä¼šæ£€æµ‹ Windows ç¯å¢ƒå¹¶åº”ç”¨é€‚å½“çš„äº‹ä»¶å¾ªç¯ç­–ç•¥

- **æ•°æ®éªŒè¯**: Pydantic- å¦‚æœä»æœ‰é—®é¢˜ï¼ŒPlaywright ä¼šè‡ªåŠ¨é™çº§åˆ°åŸºç¡€ HTTP æŠ“å–

- **ç¼“å­˜ç³»ç»Ÿ**: Redis (å¯é€‰)- é™çº§æ¨¡å¼ä¸‹åŠŸèƒ½æœ‰é™ï¼ˆæ— å›¾ç‰‡ä¸‹è½½ã€æ—  Markdownï¼‰wn æ ¼å¼

- **HTTPå®¢æˆ·ç«¯**: httpx- **ç¼“å­˜ä¼˜åŒ–**ï¼šRedis ç¼“å­˜é¿å…é‡å¤æŠ“å–

- **æ•°æ®åº“**: æœ¬åœ°æ–‡ä»¶å­˜å‚¨ + JSONç´¢å¼•

## ğŸš€ å¿«é€Ÿå¼€å§‹

## ğŸ“¦ å®‰è£…éƒ¨ç½²

### 1. å®‰è£…ä¾èµ–

### ç¯å¢ƒè¦æ±‚

```bash

- Python 3.8+pip install -r requirements.txt

- Node.js (ç”¨äºPlaywright)playwright install chromium

- Redis (å¯é€‰ï¼Œç”¨äºç¼“å­˜)```



### 1. å…‹éš†é¡¹ç›®### 2. Redis é…ç½®ï¼ˆå¯é€‰ï¼‰



```bash#### é€‰é¡¹ Aï¼šä½¿ç”¨ Redisï¼ˆæ¨èï¼Œç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰

git clone https://github.com/xfrrn/hotlist-crawler.git

cd hotlist-crawler**Windows ç”¨æˆ·ï¼š**

``````bash

# ä½¿ç”¨ Chocolatey å®‰è£… Redis

### 2. å®‰è£…ä¾èµ–choco install redis-64



```bash# æˆ–è€…ä¸‹è½½ Redis for Windows

# å®‰è£…Pythonä¾èµ–# è®¿é—®ï¼šhttps://github.com/microsoftarchive/redis/releases

pip install -r requirements.txt

# å¯åŠ¨ Redis æœåŠ¡

# å®‰è£…Playwrightæµè§ˆå™¨redis-server

playwright install chromium

```# åœ¨æ–°çš„ç»ˆç«¯çª—å£æµ‹è¯•è¿æ¥

redis-cli ping

### 3. Redis é…ç½®ï¼ˆå¯é€‰ä½†æ¨èï¼‰```



#### Windows ç”¨æˆ·ï¼š**å…¶ä»–ç³»ç»Ÿï¼š**

```bash```bash

# ä½¿ç”¨ Chocolatey å®‰è£… Redis# Ubuntu/Debian

choco install redis-64sudo apt-get install redis-server

sudo systemctl start redis-server

# æˆ–è€…ä¸‹è½½ Redis for Windows

# è®¿é—®ï¼šhttps://github.com/microsoftarchive/redis/releases# macOS

brew install redis

# å¯åŠ¨ Redis æœåŠ¡brew services start redis

redis-server

# æµ‹è¯•è¿æ¥

# åœ¨æ–°çš„ç»ˆç«¯çª—å£æµ‹è¯•è¿æ¥redis-cli ping

redis-cli ping```

```

#### é€‰é¡¹ Bï¼šæ—  Redis æ¨¡å¼ï¼ˆå¼€å‘/æµ‹è¯•ï¼‰

#### å…¶ä»–ç³»ç»Ÿï¼š

```bashå¦‚æœä¸å®‰è£… Redisï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨å†…å­˜ç¼“å­˜ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

# Ubuntu/Debian

sudo apt-get install redis-server### 3. å¯åŠ¨ API æœåŠ¡

sudo systemctl start redis-server

```bash

# macOSuvicorn app.main:app --reload

brew install redis```

brew services start redis

### 4. è®¿é—® API æ–‡æ¡£

# æµ‹è¯•è¿æ¥

redis-cli pingæ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:8000/docs` æŸ¥çœ‹ API æ–‡æ¡£

```

## ğŸ“‹ API ä½¿ç”¨ç¤ºä¾‹

#### æ—  Redis æ¨¡å¼ï¼ˆå¼€å‘/æµ‹è¯•ï¼‰

å¦‚æœä¸å®‰è£… Redisï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨å†…å­˜ç¼“å­˜ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚### åŸºç¡€æŠ“å–ï¼ˆä»…æ–‡æœ¬ï¼‰



### 4. å¯åŠ¨æœåŠ¡```bash

curl -X POST "http://localhost:8000/scrape" \

```bash     -H "Content-Type: application/json" \

# æ–¹å¼ä¸€ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬     -d '{

python run_server.py       "url": "https://mp.weixin.qq.com/s/your-article-url",

       "save_images": false,

# æ–¹å¼äºŒï¼šä½¿ç”¨uvicorn       "output_format": "text"

uvicorn app.main:app --reload --host 0.0.0.0 --port 8000     }'

```

# æ–¹å¼ä¸‰ï¼šä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶ (Windows)

start_server.bat### é«˜çº§æŠ“å–ï¼ˆåŒ…å«å›¾ç‰‡å’Œ Markdownï¼‰

```

```bash

### 5. è®¿é—®æœåŠ¡curl -X POST "http://localhost:8000/scrape" \

     -H "Content-Type: application/json" \

- **APIæ–‡æ¡£**: http://localhost:8000/docs     -d '{

- **å¥åº·æ£€æŸ¥**: http://localhost:8000/       "url": "https://mp.weixin.qq.com/s/your-article-url",

       "save_images": true,

## ğŸš€ å¿«é€Ÿå¼€å§‹       "output_format": "markdown"

     }'

### APIè°ƒç”¨ç¤ºä¾‹```



#### 1. æŠ“å–å¾®ä¿¡å…¬ä¼—å·æ–‡ç« ## ğŸ“Š å“åº”ç¤ºä¾‹



```python```json

import requests{

  "platform": "weixin_mp",

response = requests.post("http://localhost:8000/scrape", json={  "source_url": "https://mp.weixin.qq.com/s/example",

    "url": "https://mp.weixin.qq.com/s/your-article-url",  "data": {

    "save_images": True,    "title": "æ–‡ç« æ ‡é¢˜",

    "output_format": "markdown",    "author": "ä½œè€…åç§°",

    "force_save": True    "content": "çº¯æ–‡æœ¬å†…å®¹...",

})    "markdown_content": "# æ–‡ç« æ ‡é¢˜\n**ä½œè€…:** ä½œè€…åç§°\n\næ–‡ç« å†…å®¹...",

    "images": [

print(response.json())      {

```        "original_url": "https://example.com/image.jpg",

        "local_path": "image_1.jpg",

#### 2. æŠ“å–çŸ¥ä¹é—®é¢˜        "alt_text": "å›¾ç‰‡æè¿°"

      }

```python    ],

import requests    "save_directory": "./downloads/æ–‡ç« æ ‡é¢˜"

  },

response = requests.post("http://localhost:8000/scrape", json={  "scrape_time": "2025-09-30T10:00:00+08:00"

    "url": "https://www.zhihu.com/question/123456789",}

    "save_images": True,```

    "output_format": "markdown",

    "force_save": True## âš™ï¸ é…ç½®é€‰é¡¹

})

### ç¯å¢ƒå˜é‡é…ç½®ï¼ˆ.env æ–‡ä»¶ï¼‰

print(response.json())

``````bash

# Redis é…ç½®

#### 3. æŠ“å–å¾®åšæœç´¢ç»“æœREDIS_URL=redis://localhost:6379

CACHE_EXPIRE_SECONDS=3600

```python

import requests# ä¸‹è½½é…ç½®

DOWNLOAD_DIR=./downloads

response = requests.post("http://localhost:8000/scrape", json={MAX_IMAGE_SIZE=10485760  # 10MB

    "url": "https://s.weibo.com/weibo?q=æœç´¢å…³é”®è¯",

    "save_images": True,# Playwright é…ç½®

    "output_format": "markdown", PLAYWRIGHT_HEADLESS=true

    "force_save": TruePLAYWRIGHT_TIMEOUT=90000

})```



print(response.json())## ğŸ”§ æ”¯æŒçš„å¹³å°

```

| å¹³å° | åŸŸå | åŠŸèƒ½æ”¯æŒ |

### curl å‘½ä»¤ç¤ºä¾‹|------|------|----------|

| çŸ¥ä¹ | zhuanlan.zhihu.com, www.zhihu.com | åŸºç¡€æ–‡æœ¬æŠ“å– |

```bash| å¾®ä¿¡å…¬ä¼—å· | mp.weixin.qq.com | å…¨åŠŸèƒ½ï¼ˆå›¾ç‰‡ã€Markdownï¼‰ |

# åŸºç¡€æŠ“å–ï¼ˆä»…æ–‡æœ¬ï¼‰

curl -X POST "http://localhost:8000/scrape" \\## ğŸ¨ æ–°åŠŸèƒ½ç‰¹ç‚¹

     -H "Content-Type: application/json" \\

     -d '{### 1. æ™ºèƒ½å›¾ç‰‡å¤„ç†

       "url": "https://mp.weixin.qq.com/s/your-article-url",- è‡ªåŠ¨ä¸‹è½½æ–‡ç« ä¸­çš„å›¾ç‰‡

       "save_images": false,- æ”¯æŒå¤§å°é™åˆ¶ï¼ˆé»˜è®¤ 10MBï¼‰

       "output_format": "text"- è‡ªåŠ¨é‡å‘½åé¿å…å†²çª

     }'

### 2. Markdown è½¬æ¢

# é«˜çº§æŠ“å–ï¼ˆåŒ…å«å›¾ç‰‡å’Œ Markdownï¼‰- ä¿æŒåŸæ–‡æ ¼å¼ç»“æ„

curl -X POST "http://localhost:8000/scrape" \\- å›¾ç‰‡è‡ªåŠ¨è½¬æ¢ä¸ºæœ¬åœ°è·¯å¾„

     -H "Content-Type: application/json" \\- æ”¯æŒä»£ç å—ã€å¼•ç”¨ç­‰æ ¼å¼

     -d '{

       "url": "https://mp.weixin.qq.com/s/your-article-url",### 3. åçˆ¬è™«æœºåˆ¶

       "save_images": true,- ä½¿ç”¨ Playwright æ¨¡æ‹ŸçœŸå®æµè§ˆå™¨

       "output_format": "markdown",- æŒä¹…åŒ–æµè§ˆå™¨ä¸Šä¸‹æ–‡

       "force_save": true- åè‡ªåŠ¨åŒ–æ£€æµ‹

     }'

```### 4. ç¼“å­˜ä¼˜åŒ–

- åŸºäº URL å’Œå‚æ•°çš„æ™ºèƒ½ç¼“å­˜

### æŸ¥çœ‹å­˜å‚¨å†…å®¹- Redis å­˜å‚¨ï¼Œæ”¯æŒè¿‡æœŸæ—¶é—´

- é¿å…é‡å¤æŠ“å–

```python

import requests## ğŸ› ï¸ æ‰©å±•å¼€å‘



# è·å–æ‰€æœ‰å¹³å°å­˜å‚¨æ‘˜è¦### æ·»åŠ æ–°å¹³å°æ”¯æŒ

response = requests.get("http://localhost:8000/storage/platforms")

print(response.json())1. åœ¨ `app/providers/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„ Provider ç±»

2. ç»§æ‰¿ `BaseProvider` å¹¶å®ç° `fetch_and_parse` æ–¹æ³•

# è·å–ç‰¹å®šå¹³å°å†…å®¹3. åœ¨ `app/config.py` ä¸­æ·»åŠ å¹³å°é…ç½®

response = requests.get("http://localhost:8000/storage/platform/weixin_mp")4. åœ¨ `app/main.py` ä¸­æ³¨å†Œ Provider

print(response.json())

```### è‡ªå®šä¹‰æŠ“å–è§„åˆ™



## ğŸ“ ç›®å½•ç»“æ„ä¿®æ”¹ `app/config.py` ä¸­çš„ `PLATFORMS` é…ç½®ï¼š



``````python

hotlist-crawler/PLATFORMS = {

â”œâ”€â”€ app/                          # åº”ç”¨æ ¸å¿ƒä»£ç     "your_platform": {

â”‚   â”œâ”€â”€ __init__.py        "domains": ["example.com"],

â”‚   â”œâ”€â”€ main.py                   # FastAPIåº”ç”¨ä¸»æ–‡ä»¶        "rules": {

â”‚   â”œâ”€â”€ config.py                 # é…ç½®ç®¡ç†            "title_selector": ".title",

â”‚   â”œâ”€â”€ cache.py                  # ç¼“å­˜ç³»ç»Ÿ            "content_selector": ".content",

â”‚   â”œâ”€â”€ models.py                 # æ•°æ®æ¨¡å‹        }

â”‚   â”œâ”€â”€ storage.py                # å­˜å‚¨ç®¡ç†ç³»ç»Ÿ    }

â”‚   â””â”€â”€ providers/                # å¹³å°æä¾›è€…}

â”‚       â”œâ”€â”€ __init__.py```

â”‚       â”œâ”€â”€ base.py               # åŸºç¡€æä¾›è€…ç±»

â”‚       â”œâ”€â”€ weixin.py             # å¾®ä¿¡å…¬ä¼—å·çˆ¬è™«## ğŸš¨ æ³¨æ„äº‹é¡¹

â”‚       â”œâ”€â”€ zhihu.py              # çŸ¥ä¹çˆ¬è™«

â”‚       â””â”€â”€ weibo.py              # å¾®åšçˆ¬è™«1. **é¦–æ¬¡ä½¿ç”¨éœ€è¦å®‰è£… Playwright æµè§ˆå™¨**ï¼š`playwright install chromium`

â”œâ”€â”€ downloads/                    # æœ¬åœ°å­˜å‚¨ç›®å½•2. **Redis æ˜¯å¯é€‰çš„**ï¼š

â”‚   â”œâ”€â”€ weixin_mp/               # å¾®ä¿¡å…¬ä¼—å·å†…å®¹   - âœ… æœ‰ Redisï¼šä½¿ç”¨æŒä¹…åŒ–ç¼“å­˜ï¼Œé‡å¯æœåŠ¡åç¼“å­˜ä¾ç„¶æœ‰æ•ˆ

â”‚   â”œâ”€â”€ zhihu/                   # çŸ¥ä¹å†…å®¹   - âš ï¸ æ—  Redisï¼šä½¿ç”¨å†…å­˜ç¼“å­˜ï¼Œé‡å¯æœåŠ¡åç¼“å­˜ä¼šä¸¢å¤±

â”‚   â””â”€â”€ weibo/                   # å¾®åšå†…å®¹3. **å¾®ä¿¡å…¬ä¼—å·æ–‡ç« å¯èƒ½éœ€è¦æ‰‹åŠ¨å¤„ç†éªŒè¯ç **ï¼ˆåœ¨å¼€å‘æ¨¡å¼ headless=False æ—¶ï¼‰

â”œâ”€â”€ chrome_user_data/            # æµè§ˆå™¨ç”¨æˆ·æ•°æ®4. **å›¾ç‰‡ä¸‹è½½éœ€è¦è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´**

â”œâ”€â”€ requirements.txt             # Pythonä¾èµ–5. **éµå®ˆç½‘ç«™çš„ robots.txt å’Œä½¿ç”¨æ¡æ¬¾**

â”œâ”€â”€ run_server.py               # å¯åŠ¨è„šæœ¬

â”œâ”€â”€ start_server.bat            # Windowså¯åŠ¨è„šæœ¬## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

â”œâ”€â”€ test_*.py                   # æµ‹è¯•è„šæœ¬

â””â”€â”€ README.md                   # é¡¹ç›®è¯´æ˜1. åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è®¾ç½® `PLAYWRIGHT_HEADLESS=true`

```2. è°ƒæ•´ç¼“å­˜è¿‡æœŸæ—¶é—´ä»¥å¹³è¡¡æ€§èƒ½å’Œæ•°æ®æ–°é²œåº¦

3. ä½¿ç”¨é€‚å½“çš„å›¾ç‰‡å¤§å°é™åˆ¶

## ğŸ“‚ å­˜å‚¨ç»“æ„4. è€ƒè™‘ä½¿ç”¨ä»£ç†æˆ–åˆ†å¸ƒå¼éƒ¨ç½²å¤„ç†å¤§é‡è¯·æ±‚



æ¯ä¸ªå¹³å°çš„å†…å®¹éƒ½ä¼šæŒ‰ä»¥ä¸‹ç»“æ„å­˜å‚¨ï¼š## ğŸ”§ æ•…éšœæ’é™¤



```### å¸¸è§é—®é¢˜

downloads/

â”œâ”€â”€ weixin_mp/                   # å¾®ä¿¡å…¬ä¼—å·#### 1. Redis è¿æ¥é”™è¯¯

â”‚   â”œâ”€â”€ <æ–‡ç« ID>_<æ ‡é¢˜>/```

â”‚   â”‚   â”œâ”€â”€ <æ ‡é¢˜>.txt          # çº¯æ–‡æœ¬å†…å®¹redis.exceptions.ConnectionError: Error connecting to localhost:6379

â”‚   â”‚   â”œâ”€â”€ <æ ‡é¢˜>.md           # Markdownæ ¼å¼```

â”‚   â”‚   â”œâ”€â”€ metadata.json       # å…ƒæ•°æ®ä¿¡æ¯

â”‚   â”‚   â”œâ”€â”€ images/             # æ–‡ç« å›¾ç‰‡**è§£å†³æ–¹æ¡ˆï¼š**

â”‚   â”‚   â””â”€â”€ attachments/        # é™„ä»¶æ–‡ä»¶- ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°å†…å­˜ç¼“å­˜ï¼Œç»§ç»­æ­£å¸¸å·¥ä½œ

â”‚   â””â”€â”€ articles_index.json     # æ–‡ç« ç´¢å¼•- å¦‚éœ€ Redis ç¼“å­˜ï¼Œè¯·æŒ‰ç…§ä¸Šæ–¹è¯´æ˜å®‰è£…å¹¶å¯åŠ¨ Redis æœåŠ¡

â”œâ”€â”€ zhihu/                      # çŸ¥ä¹å†…å®¹

â”‚   â”œâ”€â”€ <é—®é¢˜ID>_<æ ‡é¢˜>/#### 2. Playwright æµè§ˆå™¨æœªå®‰è£…

â”‚   â”‚   â”œâ”€â”€ <æ ‡é¢˜>.txt```

â”‚   â”‚   â”œâ”€â”€ <æ ‡é¢˜>.mdplaywright._impl._api_types.Error: Executable doesn't exist

â”‚   â”‚   â”œâ”€â”€ data.json           # å®Œæ•´é—®é¢˜å’Œå›ç­”æ•°æ®```

â”‚   â”‚   â”œâ”€â”€ metadata.json

â”‚   â”‚   â””â”€â”€ images/**è§£å†³æ–¹æ¡ˆï¼š**

â”‚   â”‚       â”œâ”€â”€ question_images/ # é—®é¢˜æè¿°å›¾ç‰‡```bash

â”‚   â”‚       â”œâ”€â”€ answer_1_<ä½œè€…>/ # å›ç­”1çš„å›¾ç‰‡playwright install chromium

â”‚   â”‚       â””â”€â”€ answer_2_<ä½œè€…>/ # å›ç­”2çš„å›¾ç‰‡```

â””â”€â”€ weibo/                      # å¾®åšå†…å®¹

    â”œâ”€â”€ <æœç´¢è¯>_<ä½œè€…>_<æ—¶é—´>/#### 3. å¾®ä¿¡å…¬ä¼—å·æŠ“å–å¤±è´¥

    â”‚   â”œâ”€â”€ <æ ‡é¢˜>.txt- æŸäº›æ–‡ç« å¯èƒ½æœ‰åçˆ¬è™«ä¿æŠ¤

    â”‚   â”œâ”€â”€ <æ ‡é¢˜>.md- å°è¯•è®¾ç½® `PLAYWRIGHT_HEADLESS=false` è¿›è¡Œæ‰‹åŠ¨éªŒè¯

    â”‚   â”œâ”€â”€ post_data.json      # å®Œæ•´å¸–å­æ•°æ®- æ£€æŸ¥æ–‡ç« é“¾æ¥æ˜¯å¦æœ‰æ•ˆ

    â”‚   â”œâ”€â”€ metadata.json

    â”‚   â”œâ”€â”€ images/             # å¸–å­å›¾ç‰‡#### 5. å¾®ä¿¡å…¬ä¼—å·æŠ“å–å¤±è´¥

    â”‚   â””â”€â”€ attachments/        # è§†é¢‘æ–‡ä»¶- æŸäº›æ–‡ç« å¯èƒ½æœ‰åçˆ¬è™«ä¿æŠ¤

```- å°è¯•è®¾ç½® `PLAYWRIGHT_HEADLESS=false` è¿›è¡Œæ‰‹åŠ¨éªŒè¯

- æ£€æŸ¥æ–‡ç« é“¾æ¥æ˜¯å¦æœ‰æ•ˆ

## ğŸ“Š APIå“åº”ç¤ºä¾‹

#### 6. å›¾ç‰‡ä¸‹è½½å¤±è´¥

```json- æ£€æŸ¥ç½‘ç»œè¿æ¥

{- ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´

  "platform": "weixin_mp",- æŸäº›å›¾ç‰‡å¯èƒ½æœ‰é˜²ç›—é“¾ä¿æŠ¤

  "source_url": "https://mp.weixin.qq.com/s/example",

  "data": {### æ—¥å¿—ä¿¡æ¯è¯´æ˜

    "title": "æ–‡ç« æ ‡é¢˜",

    "author": "ä½œè€…åç§°",**ç¼“å­˜ç›¸å…³ï¼š**

    "content": "çº¯æ–‡æœ¬å†…å®¹...",- `âœ… Redis è¿æ¥æˆåŠŸ`ï¼šRedis å·¥ä½œæ­£å¸¸

    "markdown_content": "# æ–‡ç« æ ‡é¢˜\\n**ä½œè€…:** ä½œè€…åç§°\\n\\næ–‡ç« å†…å®¹...",- `âš ï¸ Redis è¿æ¥å¤±è´¥ï¼Œä½¿ç”¨å†…å­˜ç¼“å­˜`ï¼šè‡ªåŠ¨é™çº§åˆ°å†…å­˜ç¼“å­˜

    "images": [- `âš ï¸ Redis è¯»å–/å†™å…¥å¤±è´¥ï¼Œåˆ‡æ¢åˆ°å†…å­˜ç¼“å­˜`ï¼šè¿è¡Œæ—¶åˆ‡æ¢åˆ°å†…å­˜ç¼“å­˜

      {

        "original_url": "https://example.com/image.jpg",**æŠ“å–ç›¸å…³ï¼š**

        "local_path": "./downloads/weixin_mp/article_123/images/image_1.jpg",- `ğŸŒ æ­£åœ¨è®¿é—®é¡µé¢`ï¼šå¼€å§‹æŠ“å–

        "alt_text": "å›¾ç‰‡æè¿°"- `âœ… é¡µé¢å†…å®¹å·²åŠ è½½`ï¼šPlaywright æŠ“å–æˆåŠŸ

      }- `âš ï¸ Playwright æŠ“å–å¤±è´¥`ï¼šæ­£åœ¨å°è¯•é™çº§æ–¹æ¡ˆ

    ],- `ğŸ”„ ä½¿ç”¨é™çº§æ–¹æ¡ˆï¼šåŸºç¡€ HTTP æŠ“å–`ï¼šä½¿ç”¨ç®€åŒ–æŠ“å–æ¨¡å¼

    "save_directory": "./downloads/weixin_mp/article_123"- `âœ… ä½¿ç”¨é€‰æ‹©å™¨ 'xxx' æ‰¾åˆ°æ ‡é¢˜/ä½œè€…/å†…å®¹`ï¼šé™çº§æ–¹æ¡ˆæˆåŠŸåŒ¹é…

  },- `âœ… é™çº§æ–¹æ¡ˆæŠ“å–æˆåŠŸ`ï¼šé™çº§æ–¹æ¡ˆå®Œæˆ

  "scrape_time": "2025-10-02T10:00:00+08:00"- `ğŸ“„ Markdown æ–‡ä»¶å·²ä¿å­˜åˆ°`ï¼šæ–‡ä»¶ä¿å­˜æˆåŠŸ

}

```## ï¿½ å¿«é€Ÿæµ‹è¯•



## ğŸ”§ æ”¯æŒçš„å¹³å°è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯æ‰€æœ‰åŠŸèƒ½ï¼š

```bash

| å¹³å° | åŸŸå | åŠŸèƒ½æ”¯æŒ | ç‰¹æ®ŠåŠŸèƒ½ |python test_api.py

|------|------|----------|----------|```

| å¾®ä¿¡å…¬ä¼—å· | mp.weixin.qq.com | âœ… å…¨åŠŸèƒ½ | å›¾ç‰‡ä¸‹è½½ã€Markdownè½¬æ¢ã€ç§»åŠ¨ç«¯é€‚é… |

| çŸ¥ä¹é—®é¢˜ | www.zhihu.com/question | âœ… å…¨åŠŸèƒ½ | è‡ªåŠ¨ç™»å½•ã€é—®é¢˜å±•å¼€ã€å¤šå›ç­”æŠ“å– |æµ‹è¯•è„šæœ¬ä¼šéªŒè¯ï¼š

| çŸ¥ä¹æ–‡ç«  | zhuanlan.zhihu.com | âœ… å…¨åŠŸèƒ½ | æ–‡ç« å†…å®¹ã€å›¾ç‰‡ä¸‹è½½ |- API å¥åº·æ£€æŸ¥

| å¾®åšæœç´¢ | s.weibo.com/weibo | âœ… å…¨åŠŸèƒ½ | æœç´¢ç»“æœã€å›¾ç‰‡/è§†é¢‘ä¸‹è½½ã€äº’åŠ¨æ•°æ® |- å¤šä¸ªå¾®ä¿¡å…¬ä¼—å·é“¾æ¥çš„æŠ“å–

- é«˜çº§åŠŸèƒ½ï¼ˆå›¾ç‰‡ä¸‹è½½ + Markdownï¼‰

## âš™ï¸ é…ç½®é€‰é¡¹- é”™è¯¯å¤„ç†å’Œé™çº§æœºåˆ¶



### ç¯å¢ƒå˜é‡é…ç½®ï¼ˆ.env æ–‡ä»¶ï¼‰### è¿è¡ŒçŠ¶æ€æŒ‡ç¤º



```bashå½“æ‚¨çœ‹åˆ°è¿™äº›æ—¥å¿—æ—¶ï¼š

# æœåŠ¡å™¨é…ç½®- `âœ… é¡µé¢å†…å®¹å·²åŠ è½½` â†’ Playwright å·¥ä½œæ­£å¸¸ï¼ŒåŠŸèƒ½å®Œæ•´

HOST=0.0.0.0- `ğŸ”„ ä½¿ç”¨é™çº§æ–¹æ¡ˆ` â†’ è‡ªåŠ¨é™çº§ï¼ŒåŠŸèƒ½å—é™ä½†å¯ç”¨

PORT=8000- `âœ… é™çº§æ–¹æ¡ˆæŠ“å–æˆåŠŸ` â†’ é™çº§æ–¹æ¡ˆæ­£å¸¸å·¥ä½œ

DEBUG=True- `âš ï¸ Redis è¿æ¥å¤±è´¥ï¼Œä½¿ç”¨å†…å­˜ç¼“å­˜` â†’ ç¼“å­˜é™çº§ï¼Œæ­£å¸¸å·¥ä½œ



# Redisé…ç½® (å¯é€‰)## ï¿½ğŸ¤ è´¡çŒ®æŒ‡å—

REDIS_HOST=localhost

REDIS_PORT=6379æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›é¡¹ç›®ï¼

REDIS_PASSWORD=

REDIS_DB=0---



# å­˜å‚¨é…ç½®**é¡¹ç›®ç»´æŠ¤è€…**: è¯·æ ¹æ®å®é™…æƒ…å†µæ›´æ–°æ–‡æ¡£å†…å®¹
DOWNLOAD_DIR=./downloads
MAX_FILE_SIZE=100MB

# Playwrighté…ç½®
PLAYWRIGHT_TIMEOUT=90000
BROWSER_HEADLESS=False
```

### è¯·æ±‚å‚æ•°è¯´æ˜

| å‚æ•° | ç±»å‹ | å¿…éœ€ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| url | string | âœ… | - | è¦æŠ“å–çš„æ–‡ç« é“¾æ¥ |
| save_images | boolean | âŒ | true | æ˜¯å¦ä¸‹è½½å›¾ç‰‡åˆ°æœ¬åœ° |
| output_format | string | âŒ | "markdown" | è¾“å‡ºæ ¼å¼ï¼š"text", "markdown", "html" |
| force_save | boolean | âŒ | true | æ˜¯å¦å¼ºåˆ¶ä¿å­˜æ‰€æœ‰å†…å®¹åˆ°æœ¬åœ° |

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•è„šæœ¬

```bash
# æµ‹è¯•å¾®ä¿¡å…¬ä¼—å·åŠŸèƒ½
python test_weixin_integration.py

# æµ‹è¯•çŸ¥ä¹åŠŸèƒ½  
python test_zhihu_integration.py

# æµ‹è¯•å¾®åšåŠŸèƒ½
python test_weibo_integration.py

# æµ‹è¯•å­˜å‚¨åŠŸèƒ½
python test_storage.py
```

### å•å…ƒæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python -m pytest tests/

# è¿è¡Œç‰¹å®šæµ‹è¯•
python -m pytest tests/test_providers/
```

## ğŸš¨ æ³¨æ„äº‹é¡¹

### ç™»å½•è¦æ±‚
- **å¾®ä¿¡å…¬ä¼—å·**: æ— éœ€ç™»å½•ï¼Œç›´æ¥æŠ“å–
- **çŸ¥ä¹**: é¦–æ¬¡ä½¿ç”¨éœ€è¦æ‰‹åŠ¨ç™»å½•ï¼Œç™»å½•çŠ¶æ€ä¼šä¿æŒ
- **å¾®åš**: é¦–æ¬¡ä½¿ç”¨éœ€è¦æ‰‹åŠ¨ç™»å½•ï¼Œç™»å½•çŠ¶æ€ä¼šä¿æŒ

### ä½¿ç”¨é™åˆ¶
- è¯·åˆç†ä½¿ç”¨ï¼Œé¿å…å¯¹ç›®æ ‡ç½‘ç«™é€ æˆè¿‡å¤§å‹åŠ›
- å»ºè®®è®¾ç½®åˆé€‚çš„è¯·æ±‚é—´éš”
- éµå®ˆç›®æ ‡ç½‘ç«™çš„robots.txtå’ŒæœåŠ¡æ¡æ¬¾
- ä»…ç”¨äºå­¦ä¹ å’Œä¸ªäººä½¿ç”¨

### æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨Redisç¼“å­˜å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½
- è°ƒæ•´`PLAYWRIGHT_TIMEOUT`é€‚åº”ç½‘ç»œç¯å¢ƒ
- å¯¹äºå¤§é‡æŠ“å–ä»»åŠ¡ï¼Œå»ºè®®ä½¿ç”¨é˜Ÿåˆ—ç³»ç»Ÿ

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. Playwrightæµè§ˆå™¨æœªå®‰è£…
```
playwright._impl._api_types.Error: Executable doesn't exist
```

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
playwright install chromium
```

#### 2. Redisè¿æ¥å¤±è´¥
```
redis.exceptions.ConnectionError: Error connecting to localhost:6379
```

**è§£å†³æ–¹æ¡ˆï¼š**
- ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°å†…å­˜ç¼“å­˜ï¼Œç»§ç»­æ­£å¸¸å·¥ä½œ
- å¦‚éœ€Redisç¼“å­˜ï¼Œè¯·æŒ‰ç…§ä¸Šæ–¹è¯´æ˜å®‰è£…å¹¶å¯åŠ¨RedisæœåŠ¡

#### 3. Windowsç³»ç»ŸPlaywrightå¼‚æ­¥é”™è¯¯
```
NotImplementedError: Task exception was never retrieved
```

**è§£å†³æ–¹æ¡ˆï¼š**
- å·²è‡ªåŠ¨ä¿®å¤ï¼šç³»ç»Ÿä¼šæ£€æµ‹Windowsç¯å¢ƒå¹¶åº”ç”¨é€‚å½“çš„äº‹ä»¶å¾ªç¯ç­–ç•¥
- å¦‚æœä»æœ‰é—®é¢˜ï¼ŒPlaywrightä¼šè‡ªåŠ¨é™çº§åˆ°åŸºç¡€HTTPæŠ“å–

#### 4. å›¾ç‰‡ä¸‹è½½å¤±è´¥
- æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œç£ç›˜ç©ºé—´
- æŸäº›å›¾ç‰‡å¯èƒ½æœ‰é˜²ç›—é“¾ä¿æŠ¤
- æ£€æŸ¥å›¾ç‰‡å¤§å°æ˜¯å¦è¶…è¿‡é™åˆ¶

#### 5. æŠ“å–å†…å®¹ä¸ºç©º
- æ£€æŸ¥URLæ˜¯å¦æœ‰æ•ˆ
- æŸäº›é¡µé¢å¯èƒ½éœ€è¦ç™»å½•
- å°è¯•è®¾ç½®`BROWSER_HEADLESS=False`æ‰‹åŠ¨å¤„ç†

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è°ƒè¯•æ¨¡å¼
export DEBUG=True
python run_server.py

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
tail -f logs/debug.log
```

## ğŸ“ˆ æ€§èƒ½ç‰¹ç‚¹

- âš¡ **å¼‚æ­¥å¤„ç†** - ä½¿ç”¨å¼‚æ­¥æ¶æ„æé«˜å¹¶å‘æ€§èƒ½
- ğŸ”„ **æ™ºèƒ½é‡è¯•** - ç½‘ç»œè¯·æ±‚å¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•
- ğŸ’¾ **å†…å­˜ä¼˜åŒ–** - æµå¼ä¸‹è½½å¤§æ–‡ä»¶ï¼Œé¿å…å†…å­˜æº¢å‡º
- ğŸ¯ **ç²¾ç¡®æŠ“å–** - æ™ºèƒ½é€‰æ‹©å™¨ç¡®ä¿å†…å®¹å‡†ç¡®æå–
- ğŸ“¦ **ç¼“å­˜ä¼˜åŒ–** - é¿å…é‡å¤æŠ“å–ï¼Œæå‡å“åº”é€Ÿåº¦

## ğŸ”„ æ›´æ–°æ—¥å¿—

### v2.0.0 (2025-10-02)
- âœ¨ æ–°å¢å¾®åšæœç´¢é¡µé¢æ”¯æŒ
- âœ¨ æ–°å¢çŸ¥ä¹é—®é¢˜é¡µé¢å®Œæ•´æ”¯æŒ
- âœ¨ å®ç°ç»Ÿä¸€å­˜å‚¨ç®¡ç†ç³»ç»Ÿ
- ğŸš€ å®Œæ•´é‡æ„ä»£ç æ¶æ„
- ğŸ“¦ æ–°å¢å¤šæ ¼å¼è¾“å‡ºæ”¯æŒ

### v1.0.0 (åˆå§‹ç‰ˆæœ¬)
- âœ¨ åŸºç¡€å¾®ä¿¡å…¬ä¼—å·æ–‡ç« æŠ“å–
- ğŸ”¨ FastAPIæ¡†æ¶æ­å»º
- ğŸ’¾ Redisç¼“å­˜ç³»ç»Ÿ

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueså’ŒPull Requestsï¼

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# Forké¡¹ç›®å¹¶å…‹éš†
git clone https://github.com/your-username/hotlist-crawler.git
cd hotlist-crawler

# åˆ›å»ºå¼€å‘åˆ†æ”¯
git checkout -b feature/your-feature

# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements-dev.txt

# è¿è¡Œæµ‹è¯•
python -m pytest
```

### æäº¤è§„èŒƒ
- feat: æ–°åŠŸèƒ½
- fix: ä¿®å¤bug
- docs: æ–‡æ¡£æ›´æ–°
- style: ä»£ç æ ¼å¼è°ƒæ•´
- refactor: ä»£ç é‡æ„
- test: æµ‹è¯•ç›¸å…³

### æ·»åŠ æ–°å¹³å°æ”¯æŒ

1. åœ¨ `app/providers/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„ Provider ç±»
2. ç»§æ‰¿ `BaseProvider` å¹¶å®ç° `fetch_and_parse` æ–¹æ³•
3. åœ¨ `app/config.py` ä¸­æ·»åŠ å¹³å°é…ç½®
4. åœ¨ `app/main.py` ä¸­æ³¨å†Œ Provider

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [FastAPI](https://fastapi.tiangolo.com/) - ç°ä»£åŒ–çš„Webæ¡†æ¶
- [Playwright](https://playwright.dev/) - æµè§ˆå™¨è‡ªåŠ¨åŒ–å·¥å…·
- [BeautifulSoup](https://www.crummy.com/software/BeautifulSoup/) - HTMLè§£æåº“
- [Pydantic](https://pydantic-docs.helpmanual.io/) - æ•°æ®éªŒè¯åº“

## ğŸ“® è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€: https://github.com/xfrrn/hotlist-crawler
- é—®é¢˜åé¦ˆ: https://github.com/xfrrn/hotlist-crawler/issues
- ä½œè€…: xfrrn

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ªStaræ”¯æŒä¸€ä¸‹ï¼