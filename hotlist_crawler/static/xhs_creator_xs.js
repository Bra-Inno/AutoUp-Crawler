// Source: https://github.com/cv-cat/Spider_XHS/blob/master/static/xhs_creator_xs.js
const crypto=require("crypto");let key="7cc4adla5ay0701v",iv="4uzjr7mbsibcaldp";key=Buffer.from(key),iv=Buffer.from(iv);var encrypt=function(e){let t=crypto.createCipheriv("aes-128-cbc",key,iv),r=t.update(e,"utf8","hex");return r+t.final("hex")};function decrypt(e){let t=crypto.createDecipheriv("aes-128-cbc",key,iv),r=t.update(e,"hex","utf8");return r+t.final("utf8")}function get_xs(e,t,r){t&&(e+=JSON.stringify(t));let c=crypto.createHash("md5"),i=c.update(e).digest("hex"),n="0|0|0|1|0|0|1|0|0|0|1|0|0|0|0|1|0|0|0",a=r,s=Date.now(),p=`x1=${i};x2=${n};x3=${a};x4=${s};`,u={signSvn:"56",signType:"x2",appId:"ugc",signVersion:"1",payload:encrypt(btoa(p))};return u=JSON.stringify(u),{"X-s":u="XYW_"+btoa(u),"X-t":s}}function get_request_headers_params(e,t,r){let c=get_xs(e="url="+e,t,r),i;return{xs:c["X-s"],xt:c["X-t"]}}
